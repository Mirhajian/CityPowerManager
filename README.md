# City Power Manager
## موارد مهم
- و شماتیک پروژه در مسیر زیر قرار دارند uml فایل 

```
./docs/html/index.html این فایل را ران کنید تا پروژه را بهتر درک کنید
```
## معرفی
- این پروژه برای پایان ترم درس برنامه نویسی پیشرفته دانشگاه صنعتی بیرجند است

## قابلیت ها
- **1. Submit New Subscriber:** اضافه کردن مشترک جدید
- **2. Display Subscribers:** نمایش مشترکین برق
- **3. Edit Subscriber:** ویرایش مشترکین برق
- **4. Submit New Tariffs:** ایجاد یک لیست تعرفه جدید
- **5. Display Tariffs:** نمایش تعرفه ها
- **6. Edit Tariffs:** ویرایش تعرفه ها
- **7. Billing Issuance:** ایجاد قبض و صدور صورت حساب یک ماهه

```
```
فایل های سورس و هدر این پروژه در دو پوشه زیر قرار دارند
‍‍‍
```
./src : source files
./include : .hpp header files
```
فایل های دیتابیس در این مسیر هستند
‍‍‍
```
./data/tariffs.csv: تعرفه ها
./data/residential_subscribers.csv: دیتابیس مشترکین خانگی
./data/commercial_subscribers.csv: دیتابیس مشترکین تجاری
./data/industrial_subscribers.csv: دیتابیس مشترکین صنعتی
```
شمایل کلی پروژه

```
.
├── CMakeLists.txt
├── README.md
├── bin
├── build  # فایل اجرایی به صورت پیشرفض درون این پوشه است
├── data  # مسیر دیتابیس ها
│   ├── commercial_subscribers.csv  # دیتابیس تجاری
│   ├── industrial_subscribers.csv  # دیتابیس صنعتی
│   ├── residential_subscribers.csv  # دیتابیس خانگی
│   └── tariffs.csv  # دیتابیس تعرفه ها
├── docs
│   ├── html
│   │   └── index.html  # فایل شماتیک و نمودار زبان مدلسازی(یو ام ال)
│   │
│   └── latex
├── include  # مسیر فایل های هدر
│   ├── core  # مسیر فایل های هسته ای نرم افزار
│   │   ├── app.hpp  # هسته نرم افزار
│   │   └── billing_system.hpp  # فایل محاسبه قبض
│   ├── models  # مسیر ساختمان داده و کلاس ها
│   │   ├── commercial_subscriber.hpp  # ساختار کلاس مشترکین تجاری
│   │   ├── industrial_subscriber.hpp  # ساختار کلاس مشترکین صنعتی
│   │   ├── residential_subscriber.hpp  # ساختار کلاس مشترکین خانگی
│   │   ├── subscriber.hpp  # سختار کلاس مشترکین
│   │   └── tariff.hpp  # ساختار کلاس تعرفه ها
│   └── utils  # ابزار های کاربردی
│       ├── ascii_art.hpp  # زیبا سازی ترمینال
│       └── file_io.hpp  # برای هندل فایل های خارجی مانند دیتابیس ها
└── src  # مسیر فایل های سورس
    ├── core
    │   ├── app.cpp
    │   └── billing_system.cpp
    ├── main.cpp  # مین نرم افزار
    ├── models
    │   ├── commercial_subscriber.cpp
    │   ├── industrial_subscriber.cpp
    │   ├── residential_subscriber.cpp
    │   ├── subscriber.cpp
    │   └── tariff.cpp
    └── utils
        └── file_io.cpp


```

## نحوه محاسبه قبض ها
انجام محاسبات قبض ها و دوره ها را این فایل انجام میدهد:
```
./src/core/billing_system
```
الگوریتم کلی:
- هر روز به چهار بخش تقسیم میشود (هر بخش ۶ ساعت)
- گذر این بخش ها بر عهده یک حلقه با تعداد تکرار ۴ مرتبه است
    - مرتبه اول از ساعت ۱۲ بامداد تا ۶ صبح در نظر گرفته شده است و این ساعات میان باری در نظر گرفته شده اند که ضریب آن ها ۱ میباشد
    - ساعات بعدی از ۶ صبح تا ۱۲ ظهر هستند که کم باری در نظر گرفته شده اند و ضریب آن ها ۰.۵ است
    - ساعات ۱۲ ظهر تا ۱۸ بعد از ظهر نیز ساعات پر باری در نظر گرفته شده اند
    - ساعات ۱۸ تا ۱۲ بامداد هم میان باری با ضریب ۱ لحاظ شده اند
- یک متد رندم سازی یک عدد رندم بین ۱ و ۰ ایجاد میکند، این برای ایجاد یک مصرف کاملا رندم برای یک مشترک است تا طبیعی تر باشد
- این عدد در ۶ ضرب شده تا دوباره تبدیل به ساعت عادی شود و سپس در ضریب باری آن ساعت ضرب میشود
- تمام این پروسه ها داخل یک حلقه بالا تر با تعداد ۳۰ قرار دارند تا مصرف ۳۰ روز را شبیه سازی کنند
- سپس میزان مصرف با لیست تعرفه ها مقایسه شده و در ضریب پلکانی آن ضرب میشود و مبلغ بدست می آید
-  همین پروسه تا حدودی برای مشترکین صنعتی صادق است اما چون تعرفه پلکانی ندارند 
قیمت کل در مبلغ ساعت باری که در آن قرار دارند ضرب میشود

## واژگان
معادل واژه های انگلیسی استفاده شده برای درک بهتر پروژه:
```
01. tariff : تعرفه
02. subscriber : مشترک
03. residential : خانگی
04. commercial : تجاری
05. industrial : صنعتی
06. billing system : سیستم تولید قبض و دوره حساب

:: واژگان استفاده شده در دیتابیس ::
07. meter number : شماره کنتور
08. installation date :‌ تاریخ نصب
09. meter capacity : ظرفیت کنتور
10. business licence : پروانه تجاری
11. unit name : نام واحد
12. supply voltage : ولتاژ تغذیه
13. connection type : نوع انشعاب
14. meter multiplier : ضریب کنتور
15. transformer ratio : ضریب ترانس
16. debt : بدهی ، مربوط به بدهی قبض
17. type : نوع، منظور از نوع تعرفه(مسکونی یا تجاری یا صنعتی)
18. tier : پلکان یا رتبه
19. price : قیمت
20. light_pressure : کم باری
21. medium_pressure : میان باری
22. peak_pressure : پر باری
23. weekend_peak_pressure : باری باری آخر هفته
24. reactive_power : نیروی راکتیو

:: واژگان استفاده شده در سایر بخش های برنامه ::
25. period : بخش، منظور از یکی از بخش های چهارگانه روز که بالاتر اشاره شد
26. depricated : منسوخ شده، برخی متد های داخل کد کامنت گذاری شده اند و مربوط به ورژن قدیمی تر برنامه هستند
```

## نحوه کامپایل گیری
- با اینکه از پیش این پروژه کامپایل گرفته شده و فایل اجرایی ویندوز آن موجود است، در صورت تمایل میتوانید از این روش استفاده کنید:
### پیش نیاز ها

- C++ compiler (e.g., g++, clang++)
- CMake (از سایت رسمی دانلود کنید)

### ساختن فایل اجرایی

1. :دانلود پروژه
    ```sh
    git clone https://github.com/Mirhajian/CityPowerManager.git
    cd CityPowerManager
    ```

2. شوید build وارد پوشه

    ```sh
    cd build
    ```

3. فایل های سازنده را درست کنید cmake با استفاده از

    ```sh
    cmake ..
    ```

4. پروژه را کامپایل بگیرید

    ```sh
    cmake --build .
    ```

